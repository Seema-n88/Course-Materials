jQuery(document).ready(function(e){function a(e,a){l(e,a),e.find(a.container).first().show()}function n(a,n){if(n.tabs){var i=e("<ul />",{"class":n.tabMenuClassName}).insertBefore(a.children(n.container).filter(":first"));a.children(n.container).each(function(t,r){var l=e("<li/>").html(e(this).children(n.header).html()).addClass(0==t?n.tabMenuActiveClassName:"").addClass("item"+t).on("click keypress",{container:a.children(n.container),fieldset:e(r)},function(){var i=e(this),t=i.parent().children().index(i);s(a,n,i,t)});n.tabIndex&&l.prop("tabindex",t),i.append(l)})}}function i(a,n){n.navigation&&a.children(n.container).each(function(i){var t=e("<div />").addClass("powermail_fieldwrap").addClass("powermail_tab_navigation").appendTo(e(this));i>0&&t.append(c(a,n)),i<a.children(n.container).length-1&&t.append(o(a,n))})}function t(a,n){e.fn.parsley&&"data-parsley-validate"===a.data("parsley-validate")&&a.parsley().subscribe("parsley:field:validated",function(){b(a,n),h(a,n)})}function r(a,n){n.openTabOnError&&e.listen("parsley:field:error",function(){setTimeout(function(){a.find("."+n.tabMenuClassName+" > .parsley-error:first").click()},50)})}function s(a,n,i,t){$activeTab=m(a,n),$activeTab.removeClass(n.tabMenuActiveClassName),i.addClass(n.tabMenuActiveClassName),l(a,n),e(".powermail_fieldset",a).slice(t,t+1).show()}function l(e,a){e.children(a.container).hide()}function c(a,n){return e("<a />").prop("href","#").addClass("powermail_tab_navigation_previous").html("<").click(function(e){e.preventDefault(),u(a,n)})}function o(a,n){return e("<a />").prop("href","#").addClass("powermail_tab_navigation_next").html(">").click(function(e){e.preventDefault(),d(a,n)})}function d(e,a){var n=p(e,a);$activeTab=m(e,a),$activeTab.removeClass(a.tabMenuActiveClassName).next().addClass(a.tabMenuActiveClassName),f(e,a,n+1)}function u(e,a){var n=p(e,a);$activeTab=m(e,a),$activeTab.removeClass(a.tabMenuActiveClassName).prev().addClass(a.tabMenuActiveClassName),f(e,a,n-1)}function f(e,a,n){l(e,a),e.find(".powermail_fieldset").slice(n,n+1).show()}function p(e,a){var n=v(e,a),i=n.index(m(e,a));return parseInt(i)}function v(e,a){return e.find("."+a.tabMenuClassName+" > li")}function m(e,a){var n=v(e,a);return n.filter("."+a.tabMenuActiveClassName)}function b(e,a){var n=v(e,a);n.removeClass("parsley-error")}function h(a,n){a.parsley().isValid()||a.find(".parsley-error").each(function(){var i=a.find(".powermail_fieldset").index(e(this).closest(".powermail_fieldset")),t=v(a,n),r=t.slice(i,i+1);r.addClass("parsley-error")})}e.fn.powermailTabs=function(e){"use strict";var s=jQuery(this);e=jQuery.extend({container:"fieldset",header:"legend",tabs:!0,navigation:!0,openTabOnError:!0,tabIndex:!0,tabMenuClassName:"powermail_tabmenu",tabMenuActiveClassName:"act"},e),a(s,e),n(s,e),i(s,e),t(s,e),r(s,e)}});